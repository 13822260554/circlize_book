<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Circular Visualization in R</title>
  <meta name="description" content="This book provides a comprehensive overview of implementing circular visualization in R by cirlize package, espeically focusing on visualizaing high dimentional genomic data and revealing complex relationships by Chord diagram.">
  <meta name="generator" content="bookdown 0.3.16 and GitBook 2.6.7">

  <meta property="og:title" content="Circular Visualization in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book provides a comprehensive overview of implementing circular visualization in R by cirlize package, espeically focusing on visualizaing high dimentional genomic data and revealing complex relationships by Chord diagram." />
  <meta name="github-repo" content="jokergoo/books" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Circular Visualization in R" />
  
  <meta name="twitter:description" content="This book provides a comprehensive overview of implementing circular visualization in R by cirlize package, espeically focusing on visualizaing high dimentional genomic data and revealing complex relationships by Chord diagram." />
  

<meta name="author" content="Zuguang Gu">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="graphics.html">
<link rel="next" href="high-level-plots.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Circular Visualization in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="part"><span><b>I Part I</b></span></li>
<li class="chapter" data-level="1" data-path="circular-layout.html"><a href="circular-layout.html"><i class="fa fa-check"></i><b>1</b> Circular layout</a></li>
<li class="chapter" data-level="2" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>2</b> Graphics</a></li>
<li class="chapter" data-level="3" data-path="legends.html"><a href="legends.html"><i class="fa fa-check"></i><b>3</b> Legends</a></li>
<li class="chapter" data-level="4" data-path="high-level-plots.html"><a href="high-level-plots.html"><i class="fa fa-check"></i><b>4</b> Implement high-level plots</a></li>
<li class="chapter" data-level="5" data-path="advanced-usage.html"><a href="advanced-usage.html"><i class="fa fa-check"></i><b>5</b> Advanced usage</a></li>
<li class="part"><span><b>II Part II</b></span></li>
<li class="chapter" data-level="6" data-path="copy-regions-for-the-two-zoomed-chromosomes.html"><a href="copy-regions-for-the-two-zoomed-chromosomes.html"><i class="fa fa-check"></i><b>6</b> copy regions for the two zoomed chromosomes</a></li>
<li class="chapter" data-level="7" data-path="placeholder.html"><a href="placeholder.html"><i class="fa fa-check"></i><b>7</b> Placeholder</a></li>
<li class="part"><span><b>III Part II</b></span></li>
<li class="chapter" data-level="8" data-path="just-note-numeric-column-is-measured-in-bed.html"><a href="just-note-numeric-column-is-measured-in-bed.html"><i class="fa fa-check"></i><b>8</b> just note <code>numeric.column</code> is measured in <code>bed</code></a></li>
<li class="chapter" data-level="9" data-path="placeholder-1.html"><a href="placeholder-1.html"><i class="fa fa-check"></i><b>9</b> Placeholder</a></li>
<li class="chapter" data-level="10" data-path="note-how-horizontalline-works.html"><a href="note-how-horizontalline-works.html"><i class="fa fa-check"></i><b>10</b> note how ‘horizontalLine’ works</a></li>
<li class="chapter" data-level="11" data-path="placeholder-2.html"><a href="placeholder-2.html"><i class="fa fa-check"></i><b>11</b> Placeholder</a></li>
<li class="part"><span><b>IV Part III</b></span></li>
<li class="chapter" data-level="12" data-path="code-is-not-run-when-building-the-vignette.html"><a href="code-is-not-run-when-building-the-vignette.html"><i class="fa fa-check"></i><b>12</b> code is not run when building the vignette</a></li>
<li class="chapter" data-level="13" data-path="yang-yao-is-.html"><a href="yang-yao-is-.html"><i class="fa fa-check"></i><b>13</b> yang yao is -</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Circular Visualization in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="legends" class="section level1">
<h1><span class="header-section-number">Chapter 3</span> Legends</h1>
<p><strong>circlize</strong> provides complete freedom for users to design their own graphics by implementing the self-defined function <code>panel.fun</code>. However one drawback arises that <strong>circlize</strong> is completely blind to users’ data so that one important thing is missing for the visualization which is the legend.</p>
<p>Although legends cannot be automatically generated by <strong>circlize</strong>, by using functionality from other R packages, it is just a few more work to really implement it. Here I will demonstrate how to customize legends and arrange to the circular plot.</p>
<p>As an example, a circular plot which contains two tracks and links inside the circle is generated. The first track will have a legend that contains points, the second track will have a legend that contains lines, and the links correspond to a continuous color mapping. The code is wrapped into a function so that it can be used repeatedly.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(circlize)

col_fun =<span class="st"> </span><span class="kw">colorRamp2</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;red&quot;</span>))
circlize_plot =<span class="st"> </span><span class="cf">function</span>() {
    <span class="kw">set.seed</span>(<span class="dv">12345</span>)
    fa =<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]
    <span class="kw">circos.initialize</span>(fa, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
    <span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {
        <span class="kw">circos.points</span>(<span class="kw">runif</span>(<span class="dv">20</span>), <span class="kw">runif</span>(<span class="dv">20</span>), <span class="dt">cex =</span> <span class="fl">0.5</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="dv">2</span>)
        <span class="kw">circos.points</span>(<span class="kw">runif</span>(<span class="dv">20</span>), <span class="kw">runif</span>(<span class="dv">20</span>), <span class="dt">cex =</span> <span class="fl">0.5</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">col =</span> <span class="dv">3</span>)
    })
    <span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {
        <span class="kw">circos.lines</span>(<span class="kw">sort</span>(<span class="kw">runif</span>(<span class="dv">20</span>)), <span class="kw">runif</span>(<span class="dv">20</span>), <span class="dt">col =</span> <span class="dv">4</span>)
        <span class="kw">circos.lines</span>(<span class="kw">sort</span>(<span class="kw">runif</span>(<span class="dv">20</span>)), <span class="kw">runif</span>(<span class="dv">20</span>), <span class="dt">col =</span> <span class="dv">5</span>)
    })

    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">10</span>) {
        <span class="kw">circos.link</span>(<span class="kw">sample</span>(fa, <span class="dv">1</span>), <span class="kw">sort</span>(<span class="kw">runif</span>(<span class="dv">10</span>))[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>], 
                    <span class="kw">sample</span>(fa, <span class="dv">1</span>), <span class="kw">sort</span>(<span class="kw">runif</span>(<span class="dv">10</span>))[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>],
                    <span class="dt">col =</span> <span class="kw">add_transparency</span>(<span class="kw">col_fun</span>(<span class="kw">rnorm</span>(<span class="dv">1</span>))))
    }
    <span class="kw">circos.clear</span>()
}</code></pre></div>
<p>In <strong>ComplexHeatmap</strong> package with version higher than 1.13.2, there is a <code>Legend()</code> function which customizes legends with various styles. In following code, legends for the two tracks and links are constructed. In the end the three legends are packed vertically by <code>packLegend()</code>. For more detailed usage of <code>Legend()</code> and <code>packLegend()</code>, please refer to their help pages.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ComplexHeatmap)
<span class="co"># discrete</span>
lgd_points =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">at =</span> <span class="kw">c</span>(<span class="st">&quot;label1&quot;</span>, <span class="st">&quot;label2&quot;</span>), <span class="dt">type =</span> <span class="st">&quot;points&quot;</span>, 
    <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>), <span class="dt">title_position =</span> <span class="st">&quot;topleft&quot;</span>, 
    <span class="dt">title =</span> <span class="st">&quot;Track1&quot;</span>)
<span class="co"># discrete</span>
lgd_lines =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">at =</span> <span class="kw">c</span>(<span class="st">&quot;label3&quot;</span>, <span class="st">&quot;label4&quot;</span>), <span class="dt">type =</span> <span class="st">&quot;lines&quot;</span>, 
    <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">lwd =</span> <span class="dv">2</span>), <span class="dt">title_position =</span> <span class="st">&quot;topleft&quot;</span>, 
    <span class="dt">title =</span> <span class="st">&quot;Track2&quot;</span>)
<span class="co"># continuous</span>
lgd_links =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">at =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">col_fun =</span> col_fun, 
    <span class="dt">title_position =</span> <span class="st">&quot;topleft&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Links&quot;</span>)

lgd_list_vertical =<span class="st"> </span><span class="kw">packLegend</span>(lgd_points, lgd_lines, lgd_links)
lgd_list_vertical</code></pre></div>
<pre><code>## frame[GRID.frame.1065]</code></pre>
<p><code>lgd_points</code>, <code>lgd_lines</code>, <code>lgd_links</code> and <code>lgd_list_vertical</code> are all <code>grob</code> objects (graphical objects) defined by <strong>grid</strong> package, which you can think as boxes which contain all graphical elements for legends and they can be added to the plot by <code>grid.draw()</code>.</p>
<p><strong>circlize</strong> is implemented in the base graphic system while <strong>ComplexHeatmap</strong> is implemented by <strong>grid</strong> graphic system. However, these two systems can be mixed somehow. We can directly add grid graphics to the base graphics. (Actually they are two independent layers but drawn on a same graphic device.)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">circlize_plot</span>()
<span class="co"># next the grid graphics are added directly to the plot</span>
<span class="co"># where circlize has created.</span>
<span class="kw">pushViewport</span>(<span class="kw">viewport</span>(<span class="dt">x =</span> <span class="kw">unit</span>(<span class="dv">2</span>, <span class="st">&quot;mm&quot;</span>), <span class="dt">y =</span> <span class="kw">unit</span>(<span class="dv">4</span>, <span class="st">&quot;mm&quot;</span>), 
    <span class="dt">width =</span> <span class="kw">grobWidth</span>(lgd_list_vertical), 
    <span class="dt">height =</span> <span class="kw">grobHeight</span>(lgd_list_vertical), 
    <span class="dt">just =</span> <span class="kw">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;bottom&quot;</span>)))
<span class="kw">grid.draw</span>(lgd_list_vertical)
<span class="kw">upViewport</span>()</code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:directly-add"></span>
<img src="circlize-book_files/figure-html/directly-add-1.png" alt="Directly add grid graphics." width="384" />
<p class="caption">
Figure 3.1: Directly add grid graphics.
</p>
</div>
<p>In Figure <a href="legends.html#fig:directly-add">3.1</a>, the whole image region corresponds to the circular plot and the legend layer is drawn just on top of it. Actually you can see that one big problem is if there are many legends that the size for the legends is too big, they may overap to the circle. One solution is to split the legends into several parts and add each part to different corners in the plot (Figure <a href="#fig:two-legends"><strong>??</strong></a>).</p>
<p><img src="circlize-book_files/figure-html/two-legends-1.png" width="384" style="display: block; margin: auto;" /></p>
<p>Still it can not solve the problem and sometimes it even makes the plot so messed up. One better way is to split the image region into two parts where one part only for the circular plot and the other part for legends.</p>
<p>To mix grid graphics and base graphics, ther are two important packages to use: the <strong>grid</strong> package and <strong>gridBase</strong> package. <strong>grid</strong> is the base for making grid graphics as well as arranging plotting regions (or, viewport in <strong>grid</strong> term), and <strong>gridBase</strong> makes it easy to integrate base graphics into grid system.</p>
<p>Following code is straightforward to understand. Only one line needs to be noticed: <code>par(omi = gridOMI(), new = TRUE)</code> that <code>gridOMI()</code> calculates the outer margins for the base graphics so that the base graphics can be put at the correct place and <code>new = TRUE</code> to ensure the base graphics are added to current graphic device instead of opening a new one.</p>
<p>Here I use <code>plot.new()</code> to open a new graphic device. In interactive session, it seems ok if you also use <code>grid.newpage()</code>, but <code>grid.newpage()</code> gives error when building a <strong>knitr</strong> document.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(gridBase)
<span class="kw">plot.new</span>()
circle_size =<span class="st"> </span><span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;snpc&quot;</span>) <span class="co"># snpc unit gives you a square region</span>

<span class="kw">pushViewport</span>(<span class="kw">viewport</span>(<span class="dt">x =</span> <span class="dv">0</span>, <span class="dt">y =</span> <span class="fl">0.5</span>, <span class="dt">width =</span> circle_size, <span class="dt">height =</span> circle_size,
    <span class="dt">just =</span> <span class="kw">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;center&quot;</span>)))
<span class="kw">par</span>(<span class="dt">omi =</span> <span class="kw">gridOMI</span>(), <span class="dt">new =</span> <span class="ot">TRUE</span>)
<span class="kw">circlize_plot</span>()
<span class="kw">upViewport</span>()

<span class="kw">pushViewport</span>(<span class="kw">viewport</span>(<span class="dt">x =</span> circle_size, <span class="dt">y =</span> <span class="fl">0.5</span>, <span class="dt">width =</span> <span class="kw">grobWidth</span>(lgd_list_vertical), 
    <span class="dt">height =</span> <span class="kw">grobHeight</span>(lgd_list_vertical), <span class="dt">just =</span> <span class="kw">c</span>(<span class="st">&quot;left&quot;</span>, <span class="st">&quot;center&quot;</span>)))
<span class="kw">grid.draw</span>(lgd_list_vertical)
<span class="kw">upViewport</span>()</code></pre></div>
<p><img src="circlize-book_files/figure-html/right-legend-1.png" width="446.163575295276" style="display: block; margin: auto;" /></p>
<p>The legends can also be put at the bottom of the circular plot and it is just a matter how users arrange the grid viewports. In this case, all legends are changed to horizontal style, and three legends are packed horizontally as well.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lgd_points =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">at =</span> <span class="kw">c</span>(<span class="st">&quot;label1&quot;</span>, <span class="st">&quot;label2&quot;</span>), <span class="dt">type =</span> <span class="st">&quot;points&quot;</span>, 
    <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>), <span class="dt">title_position =</span> <span class="st">&quot;topleft&quot;</span>, 
    <span class="dt">title =</span> <span class="st">&quot;Track1&quot;</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)

lgd_lines =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">at =</span> <span class="kw">c</span>(<span class="st">&quot;label3&quot;</span>, <span class="st">&quot;label4&quot;</span>), <span class="dt">type =</span> <span class="st">&quot;lines&quot;</span>, 
    <span class="dt">legend_gp =</span> <span class="kw">gpar</span>(<span class="dt">col =</span> <span class="dv">4</span><span class="op">:</span><span class="dv">5</span>, <span class="dt">lwd =</span> <span class="dv">2</span>), <span class="dt">title_position =</span> <span class="st">&quot;topleft&quot;</span>, 
    <span class="dt">title =</span> <span class="st">&quot;Track2&quot;</span>, <span class="dt">nrow =</span> <span class="dv">1</span>)

lgd_links =<span class="st"> </span><span class="kw">Legend</span>(<span class="dt">at =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">col_fun =</span> col_fun, 
    <span class="dt">title_position =</span> <span class="st">&quot;topleft&quot;</span>, <span class="dt">title =</span> <span class="st">&quot;Links&quot;</span>, <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>)

lgd_list_horizontal =<span class="st"> </span><span class="kw">packLegend</span>(lgd_points, lgd_lines, lgd_links, 
    <span class="dt">direction =</span> <span class="st">&quot;horizontal&quot;</span>)</code></pre></div>
<p>Similar code to arrange viewports.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot.new</span>()
<span class="kw">pushViewport</span>(<span class="kw">viewport</span>(<span class="dt">x =</span> <span class="fl">0.5</span>, <span class="dt">y =</span> <span class="dv">1</span>, <span class="dt">width =</span> circle_size, <span class="dt">height =</span> circle_size,
    <span class="dt">just =</span> <span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;top&quot;</span>)))
<span class="kw">par</span>(<span class="dt">omi =</span> <span class="kw">gridOMI</span>(), <span class="dt">new =</span> <span class="ot">TRUE</span>)
<span class="kw">circlize_plot</span>()
<span class="kw">upViewport</span>()

<span class="kw">pushViewport</span>(<span class="kw">viewport</span>(<span class="dt">x =</span> <span class="fl">0.5</span>, <span class="dt">y =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>) <span class="op">-</span><span class="st"> </span>circle_size, 
    <span class="dt">width =</span> <span class="kw">grobWidth</span>(lgd_list_horizontal), <span class="dt">height =</span> <span class="kw">grobHeight</span>(lgd_list_horizontal), 
    <span class="dt">just =</span> <span class="kw">c</span>(<span class="st">&quot;center&quot;</span>, <span class="st">&quot;top&quot;</span>)))
<span class="kw">grid.draw</span>(lgd_list_horizontal)
<span class="kw">upViewport</span>()</code></pre></div>
<p><img src="circlize-book_files/figure-html/bottom-legend-1.png" width="384" style="display: block; margin: auto;" /></p>

</div>
            </section>

          </div>
        </div>
      </div>
<a href="graphics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="high-level-plots.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/04-legends.Rmd",
"text": "Edit"
},
"download": ["circlize-book.pdf", "circlize-book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
