<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Circular Visualization</title>
  <meta name="description" content="This book provides a comprehensive overview of implementing circular visualization by cirlize package in R.">
  <meta name="generator" content="bookdown 0.3.16 and GitBook 2.6.7">

  <meta property="og:title" content="Circular Visualization" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book provides a comprehensive overview of implementing circular visualization by cirlize package in R." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Circular Visualization" />
  
  <meta name="twitter:description" content="This book provides a comprehensive overview of implementing circular visualization by cirlize package in R." />
  

<meta name="author" content="Zuguang Gu">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="links.html">
<link rel="next" href="high-level-plots.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="part"><span><b>I Part I</b></span></li>
<li class="chapter" data-level="1" data-path="circular-layout.html"><a href="circular-layout.html"><i class="fa fa-check"></i><b>1</b> Circular layout</a></li>
<li class="chapter" data-level="2" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>2</b> Graphics</a></li>
<li class="chapter" data-level="3" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i><b>3</b> Links</a></li>
<li class="chapter" data-level="4" data-path="other-utilities.html"><a href="other-utilities.html"><i class="fa fa-check"></i><b>4</b> Other utilities</a><ul>
<li class="chapter" data-level="4.1" data-path="other-utilities.html"><a href="other-utilities.html#circlize_and_reverse_circlize"><i class="fa fa-check"></i><b>4.1</b> <code>circlize()</code> and <code>reverse.circlize()</code></a></li>
<li class="chapter" data-level="4.2" data-path="other-utilities.html"><a href="other-utilities.html#convert-functions"><i class="fa fa-check"></i><b>4.2</b> <code>convert_length()</code>, <code>convert_x()</code> and <code>convert_y()</code></a></li>
<li class="chapter" data-level="4.3" data-path="other-utilities.html"><a href="other-utilities.html#circos-info-and-circos-clear"><i class="fa fa-check"></i><b>4.3</b> <code>circos.info()</code> and <code>circos.clear()</code></a></li>
<li class="chapter" data-level="4.4" data-path="other-utilities.html"><a href="other-utilities.html#highlight-sectors-and-tracks"><i class="fa fa-check"></i><b>4.4</b> Highlight sectors and tracks</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="high-level-plots.html"><a href="high-level-plots.html"><i class="fa fa-check"></i><b>5</b> Implement high-level plots</a></li>
<li class="chapter" data-level="6" data-path="advanced-usage.html"><a href="advanced-usage.html"><i class="fa fa-check"></i><b>6</b> Advanced usage</a></li>
<li class="chapter" data-level="7" data-path="legends.html"><a href="legends.html"><i class="fa fa-check"></i><b>7</b> Legends</a></li>
<li class="part"><span><b>II Part II</b></span></li>
<li class="chapter" data-level="8" data-path="copy-regions-for-the-two-zoomed-chromosomes.html"><a href="copy-regions-for-the-two-zoomed-chromosomes.html"><i class="fa fa-check"></i><b>8</b> copy regions for the two zoomed chromosomes</a></li>
<li class="chapter" data-level="9" data-path="placeholder.html"><a href="placeholder.html"><i class="fa fa-check"></i><b>9</b> Placeholder</a></li>
<li class="chapter" data-level="10" data-path="just-note-numeric-column-is-measured-in-bed.html"><a href="just-note-numeric-column-is-measured-in-bed.html"><i class="fa fa-check"></i><b>10</b> just note <code>numeric.column</code> is measured in <code>bed</code></a></li>
<li class="chapter" data-level="11" data-path="placeholder-1.html"><a href="placeholder-1.html"><i class="fa fa-check"></i><b>11</b> Placeholder</a></li>
<li class="chapter" data-level="12" data-path="note-how-horizontalline-works.html"><a href="note-how-horizontalline-works.html"><i class="fa fa-check"></i><b>12</b> note how ‘horizontalLine’ works</a></li>
<li class="chapter" data-level="13" data-path="placeholder-2.html"><a href="placeholder-2.html"><i class="fa fa-check"></i><b>13</b> Placeholder</a></li>
<li class="part"><span><b>III Part III</b></span></li>
<li class="chapter" data-level="14" data-path="code-is-not-run-when-building-the-vignette.html"><a href="code-is-not-run-when-building-the-vignette.html"><i class="fa fa-check"></i><b>14</b> code is not run when building the vignette</a></li>
<li class="chapter" data-level="15" data-path="yang-yao-is-.html"><a href="yang-yao-is-.html"><i class="fa fa-check"></i><b>15</b> yang yao is -</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Circular Visualization</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="other-utilities" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Other utilities</h1>
<div id="circlize_and_reverse_circlize" class="section level2">
<h2><span class="header-section-number">4.1</span> <code>circlize()</code> and <code>reverse.circlize()</code></h2>
<p><strong>circlize</strong> transform data points in several coordinate systems and it is basically done by the core function <code>circlize()</code>. The function transforms from data coordinate (coordinate in the cells) to the polar coordinate and its companion <code>reverse.circlize()</code> transforms from polar coordinate to data coordinate. The default transformation is applied in the <code>current</code> cell.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">factors =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>)
<span class="kw">circos.initialize</span>(factors, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
<span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
<span class="co"># x = 0.5, y = 0.5 in sector a and track 1</span>
<span class="kw">circlize</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dt">sector.index =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">track.index =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>##      theta  rou
## [1,] 270.5 0.89</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># theta = 90, rou = 0.9 in the polar coordinate</span>
<span class="kw">reverse.circlize</span>(<span class="dv">90</span>, <span class="fl">0.9</span>, <span class="dt">sector.index =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">track.index =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>##             x    y
## [1,] 1.519774 0.56</code></pre>
<pre><code>##              x    y
## [1,] 0.5028249 0.56</code></pre>
<p>You can see the results are different for two <code>reverse.circlize()</code> calls although it is the same points in the polar coordinate, because they are mapped to different cells.</p>
<p><code>circlize()</code> and <code>reverse.circlize()</code> can be used to connect two circular plots if they are drawn on a same page. This provides a way to build more complex plots. Basically, the two circular plots will have a same polar coordiante, then, the manipulation of <code>circlize-&gt;reverse.circlize-&gt;circlize</code> can transform coordinate for data points from the first circular plot to the second.</p>
</div>
<div id="convert-functions" class="section level2">
<h2><span class="header-section-number">4.2</span> <code>convert_length()</code>, <code>convert_x()</code> and <code>convert_y()</code></h2>
<p>For the functions in <strong>circlize</strong> package, they needs arguments which are lengths measured either in the canvas coordinate or in the data coordinate. E.g. <code>track.height</code> argument in <code>circos.track()</code> corresponds to percent of radius in the unit circle. <strong>circlize</strong> package is built in the R base graphic system which is not straightforward to define a length with absolute units (e.g. a line of length 2 cm). <strong>circlize</strong> provides three functions which convert absolute units to the canvas coordinate or the data coordinate accordingly. <code>convert_length()</code> converts absolute units to the canvas coordinate. Since the aspect ratio for canvas coordinate is always set to 1, it doesn’t matter whether to convert units in the x direction or in the y direction. The usage of <code>convert_length()</code> is straightforward, supported units are <code>mm</code>, <code>cm</code> and <code>inches</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">convert_length</span>(<span class="dv">2</span>, <span class="st">&quot;mm&quot;</span>)</code></pre></div>
<p>Since <code>convert_length()</code> is mostly used to define heights on the radical direction, e.g. track height or height of track margins, the function has another name <code>convert_height()</code>, or the short name <code>uh()</code>.</p>
<p><code>convert_x()</code> and <code>convert_y()</code>, or the short version <code>ux()</code> and <code>uy()</code>, convert absolute units to the data coordinate. By default, the conversion is applied in the “current” cell, but it can still be specified by <code>sector.index</code> and <code>track.index</code>. Since the width of the cell is not the same from the top to the bottom in the cell, for <code>convert_x()</code> or <code>ux()</code> function, the position on y direction where the convert is applied needs to be specified. By default it is at the middle point on y-axis.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fa =<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>]
<span class="kw">circos.par</span>(<span class="dt">cell.padding =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dt">track.margin =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>))
<span class="kw">circos.initialize</span>(fa, <span class="dt">xlim =</span> <span class="kw">cbind</span>(<span class="kw">rep</span>(<span class="dv">0</span>, <span class="dv">10</span>), <span class="kw">runif</span>(<span class="dv">10</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>)))
<span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">track.height =</span> <span class="kw">uh</span>(<span class="dv">5</span>, <span class="st">&quot;mm&quot;</span>),
    <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {
        <span class="kw">circos.lines</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span> <span class="op">+</span><span class="st"> </span><span class="kw">ux</span>(<span class="dv">5</span>, <span class="st">&quot;mm&quot;</span>)), <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)
    })
<span class="kw">circos.par</span>(<span class="dt">track.margin =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">uh</span>(<span class="dv">2</span>, <span class="st">&quot;mm&quot;</span>)))
<span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">track.height =</span> <span class="kw">uh</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>),
    <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {
        xcenter =<span class="st"> </span><span class="kw">get.cell.meta.data</span>(<span class="st">&quot;xcenter&quot;</span>)
        <span class="kw">circos.lines</span>(<span class="kw">c</span>(xcenter, xcenter), <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">uy</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>)), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
    })
<span class="kw">circos.par</span>(<span class="dt">track.margin =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">uh</span>(<span class="dv">5</span>, <span class="st">&quot;mm&quot;</span>)))
<span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">track.height =</span> <span class="kw">uh</span>(<span class="dv">1</span>, <span class="st">&quot;inches&quot;</span>),
    <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {
        line_length_on_x =<span class="st"> </span><span class="kw">ux</span>(<span class="dv">1</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)
        line_length_on_y =<span class="st"> </span><span class="kw">uy</span>(<span class="dv">1</span><span class="op">*</span><span class="kw">sqrt</span>(<span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>, <span class="st">&quot;cm&quot;</span>)
        <span class="kw">circos.lines</span>(<span class="kw">c</span>(<span class="dv">0</span>, line_length_on_x), <span class="kw">c</span>(<span class="dv">0</span>, line_length_on_y), <span class="dt">col =</span> <span class="st">&quot;orange&quot;</span>)
    })</code></pre></div>
<p><img src="circlize-book_files/figure-html/unit-convert-1.png" width="576" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">circos.clear</span>()</code></pre></div>
</div>
<div id="circos-info-and-circos-clear" class="section level2">
<h2><span class="header-section-number">4.3</span> <code>circos.info()</code> and <code>circos.clear()</code></h2>
<p>You can get basic information of your current circular plot by <code>circos.info()</code>. The function can be called at any time.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">factors =<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]
<span class="kw">circos.initialize</span>(<span class="dt">factors =</span> factors, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
<span class="kw">circos.info</span>()</code></pre></div>
<pre><code>## All your sectors:
## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot;
## 
## No track has been created</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
<span class="kw">circos.info</span>(<span class="dt">sector.index =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">track.index =</span> <span class="dv">1</span>)</code></pre></div>
<pre><code>## sector index: &#39;a&#39;
## track index: 1
## xlim: [1, 2]
## ylim: [0, 1]
## cell.xlim: [0.991453, 2.008547]
## cell.ylim: [-0.1, 1.1]
## xplot (degree): [360, 241]
## yplot (radius): [0.79, 0.99]
## track.margin: c(0.01, 0.01)
## cell.padding: c(0.02, 1, 0.02, 1)
## 
## Your current sector.index is c
## Your current track.index is 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">circos.clear</span>()</code></pre></div>
<p>It can also add labels to cells by <code>circos.info(plot = TRUE)</code>.</p>
<p>You should always call <code>circos.clear()</code> at the end of every circular plot. There are several parameters for circular plot which can only be set before <code>circos.initialize()</code>, thus, before you draw the next circular plot, you need to reset all these parameters.</p>
</div>
<div id="highlight-sectors-and-tracks" class="section level2">
<h2><span class="header-section-number">4.4</span> Highlight sectors and tracks</h2>
<p><code>draw.sector()</code> draws sectors, rings or their parts. This function is useful if you want to highlight some parts of your circular plot. This function needs arguments of the position of circle center, the start degree and the end degree for sectors, and radius for two edges (or one edge) which are up or bottom borders. <code>draw.sector()</code> is independent from the circular plot.</p>
<p>Possible usage of <code>draw.sector()</code> is as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">draw.sector</span>(start.degree, end.degree, rou1)
<span class="kw">draw.sector</span>(start.degree, end.degree, rou1, rou2, center)
<span class="kw">draw.sector</span>(start.degree, end.degree, rou1, rou2, center, col, border, lwd, lty)</code></pre></div>
<p>Directions from <code>start.degree</code> and <code>end.degree</code> is important for drawing sectors. By default, it is clock wise.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">draw.sector</span>(start.degree, end.degree, <span class="dt">clock.wise =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>Following code shows examples of draw.sector().</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))
<span class="kw">plot</span>(<span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>, <span class="dt">axes =</span> <span class="ot">FALSE</span>, <span class="dt">ann =</span> <span class="ot">FALSE</span>, <span class="dt">asp =</span> <span class="dv">1</span>)
<span class="kw">draw.sector</span>(<span class="dv">20</span>, <span class="dv">0</span>)
<span class="kw">draw.sector</span>(<span class="dv">30</span>, <span class="dv">60</span>, <span class="dt">rou1 =</span> <span class="fl">0.8</span>, <span class="dt">rou2 =</span> <span class="fl">0.5</span>, <span class="dt">clock.wise =</span> <span class="ot">FALSE</span>, <span class="dt">col =</span> <span class="st">&quot;#FF000080&quot;</span>)
<span class="kw">draw.sector</span>(<span class="dv">350</span>, <span class="dv">1000</span>, <span class="dt">col =</span> <span class="st">&quot;#00FF0080&quot;</span>, <span class="dt">border =</span> <span class="ot">NA</span>)
<span class="kw">draw.sector</span>(<span class="dv">0</span>, <span class="dv">180</span>, <span class="dt">rou1 =</span> <span class="fl">0.25</span>, <span class="dt">center =</span> <span class="kw">c</span>(<span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.5</span>), <span class="dt">border =</span> <span class="dv">2</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">2</span>)
<span class="kw">draw.sector</span>(<span class="dv">0</span>, <span class="dv">360</span>, <span class="dt">rou1 =</span> <span class="fl">0.7</span>, <span class="dt">rou2 =</span> <span class="fl">0.6</span>, <span class="dt">col =</span> <span class="st">&quot;#0000FF80&quot;</span>)</code></pre></div>
<p><img src="circlize-book_files/figure-html/circlize_draw_sector_general-1.png" width="384" /></p>
<p>In order to highlight cells in the circular plot, we can use <code>get.cell.meta.data()</code> to get the information of positions of cells. E.g. the start degree and end degree can be obtained through <code>cell.start.degree</code> and <code>cell.end.degree</code>, and the position of the top border and bottom border can be obtained through <code>cell.top.radius</code> and <code>cell.bottom.radius</code>. Following code shows several examples to highlight sectors and tracks.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">factors =<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>]
<span class="kw">circos.initialize</span>(factors, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>) {
    <span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
}
<span class="kw">circos.info</span>(<span class="dt">plot =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p>If we want to highlight sector a:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">draw.sector</span>(<span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.start.degree&quot;</span>, <span class="dt">sector.index =</span> <span class="st">&quot;a&quot;</span>),
            <span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.end.degree&quot;</span>, <span class="dt">sector.index =</span> <span class="st">&quot;a&quot;</span>),
            <span class="dt">rou1 =</span> <span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.top.radius&quot;</span>, <span class="dt">track.index =</span> <span class="dv">1</span>), 
            <span class="dt">col =</span> <span class="st">&quot;#FF000040&quot;</span>)</code></pre></div>
<p>If we want to highlight track 1:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">draw.sector</span>(<span class="dv">0</span>, <span class="dv">360</span>, 
    <span class="dt">rou1 =</span> <span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.top.radius&quot;</span>, <span class="dt">track.index =</span> <span class="dv">1</span>),
    <span class="dt">rou2 =</span> <span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.bottom.radius&quot;</span>, <span class="dt">track.index =</span> <span class="dv">1</span>),
    <span class="dt">col =</span> <span class="st">&quot;#00FF0040&quot;</span>)           </code></pre></div>
<p>If we want to highlight track 2 and 3 in sector e and f:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">draw.sector</span>(<span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.start.degree&quot;</span>, <span class="dt">sector.index =</span> <span class="st">&quot;e&quot;</span>),
            <span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.end.degree&quot;</span>, <span class="dt">sector.index =</span> <span class="st">&quot;f&quot;</span>),
            <span class="dt">rou1 =</span> <span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.top.radius&quot;</span>, <span class="dt">track.index =</span> <span class="dv">2</span>),
            <span class="dt">rou2 =</span> <span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.bottom.radius&quot;</span>, <span class="dt">track.index =</span> <span class="dv">3</span>),
            <span class="dt">col =</span> <span class="st">&quot;#0000FF40&quot;</span>)</code></pre></div>
<p>If we want to highlight specific regions such as a small region inside cell <code>h:2</code>, we can use <code>circlize()</code> to calculate the positions in the polar coordinate. But always keep in mind that x-axis in the cell are always clock wise.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pos =<span class="st"> </span><span class="kw">circlize</span>(<span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>), <span class="kw">c</span>(<span class="fl">0.2</span>, <span class="fl">0.8</span>), <span class="dt">sector.index =</span> <span class="st">&quot;h&quot;</span>, <span class="dt">track.index =</span> <span class="dv">2</span>)
<span class="kw">draw.sector</span>(pos[<span class="dv">1</span>, <span class="st">&quot;theta&quot;</span>], pos[<span class="dv">2</span>, <span class="st">&quot;theta&quot;</span>], pos[<span class="dv">1</span>, <span class="st">&quot;rou&quot;</span>], pos[<span class="dv">2</span>, <span class="st">&quot;rou&quot;</span>], 
    <span class="dt">clock.wise =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;#00FFFF40&quot;</span>)
<span class="kw">circos.clear</span>()</code></pre></div>
<div class="figure">
<img src="circlize-book_files/figure-html/circlize_highlight-1.png" alt="Highlight sectors and tracks." width="384" />
<p class="caption">
(#fig:circlize_highlight)Highlight sectors and tracks.
</p>
</div>
<p>If the purpose is to simply highlight complete cells, there is a helper function <code>highlight.sector()</code> for which you only need to specify index for sectors and tracks that you want to to highlight. Paddings of the highligted regions can be set by <code>padding</code> argument which should contain four values representing ratios of the width or height of the highlighted region.</p>
<p>One advantage of <code>highlight.sector()</code> is that it supports to add text for the highlighted regions. By default, the text is drawn at that center of the highlighted region. The position on the radical direction can be set by <code>text.vjust</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">factors =<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>]
<span class="kw">circos.initialize</span>(factors, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {
    <span class="kw">circos.track</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
}
<span class="kw">circos.info</span>(<span class="dt">plot =</span> <span class="ot">TRUE</span>)

<span class="kw">highlight.sector</span>(<span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;h&quot;</span>), <span class="dt">track.index =</span> <span class="dv">1</span>, <span class="dt">text =</span> <span class="st">&quot;a and h belong to a same group&quot;</span>,
    <span class="dt">facing =</span> <span class="st">&quot;bending.inside&quot;</span>, <span class="dt">niceFacing =</span> <span class="ot">TRUE</span>, <span class="dt">text.vjust =</span> <span class="op">-</span><span class="dv">2</span>, <span class="dt">cex =</span> <span class="fl">0.8</span>)
<span class="kw">highlight.sector</span>(<span class="st">&quot;c&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;#00FF0040&quot;</span>)
<span class="kw">highlight.sector</span>(<span class="st">&quot;d&quot;</span>, <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">border =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)
<span class="kw">highlight.sector</span>(<span class="st">&quot;e&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;#0000FF40&quot;</span>, <span class="dt">track.index =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>))
<span class="kw">highlight.sector</span>(<span class="kw">c</span>(<span class="st">&quot;f&quot;</span>, <span class="st">&quot;g&quot;</span>), <span class="dt">col =</span> <span class="ot">NA</span>, <span class="dt">border =</span> <span class="st">&quot;green&quot;</span>, 
    <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">track.index =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>), <span class="dt">padding =</span> <span class="kw">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>))
<span class="kw">highlight.sector</span>(factors, <span class="dt">col =</span> <span class="st">&quot;#FFFF0040&quot;</span>, <span class="dt">track.index =</span> <span class="dv">4</span>)</code></pre></div>
<p><img src="circlize-book_files/figure-html/circlize_highlight_sector-1.png" width="384" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">circos.clear</span>()</code></pre></div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="links.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="high-level-plots.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/05-other-utilities.Rmd",
"text": "Edit"
},
"download": ["circlize-book.pdf", "circlize-book.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
