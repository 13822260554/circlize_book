<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Circular Visualization</title>
  <meta name="description" content="This book provides a comprehensive overview of implementing circular visualization by cirlize package in R.">
  <meta name="generator" content="bookdown 0.3.16 and GitBook 2.6.7">

  <meta property="og:title" content="Circular Visualization" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book provides a comprehensive overview of implementing circular visualization by cirlize package in R." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Circular Visualization" />
  
  <meta name="twitter:description" content="This book provides a comprehensive overview of implementing circular visualization by cirlize package in R." />
  

<meta name="author" content="Zuguang Gu">



  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="high-level-plots.html">
<link rel="next" href="legends.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About</a></li>
<li class="part"><span><b>I Part I</b></span></li>
<li class="chapter" data-level="1" data-path="circular-layout.html"><a href="circular-layout.html"><i class="fa fa-check"></i><b>1</b> Circular layout</a></li>
<li class="chapter" data-level="2" data-path="graphics.html"><a href="graphics.html"><i class="fa fa-check"></i><b>2</b> Graphics</a></li>
<li class="chapter" data-level="3" data-path="links.html"><a href="links.html"><i class="fa fa-check"></i><b>3</b> Links</a></li>
<li class="chapter" data-level="4" data-path="other-utilities.html"><a href="other-utilities.html"><i class="fa fa-check"></i><b>4</b> Other utilities</a></li>
<li class="chapter" data-level="5" data-path="high-level-plots.html"><a href="high-level-plots.html"><i class="fa fa-check"></i><b>5</b> Implement high-level plots</a></li>
<li class="chapter" data-level="6" data-path="advanced-usage.html"><a href="advanced-usage.html"><i class="fa fa-check"></i><b>6</b> Advanced usage</a><ul>
<li class="chapter" data-level="6.1" data-path="advanced-usage.html"><a href="advanced-usage.html#zooming-of-sectors"><i class="fa fa-check"></i><b>6.1</b> Zooming of sectors</a></li>
<li class="chapter" data-level="6.2" data-path="advanced-usage.html"><a href="advanced-usage.html#draw-part-of-the-circos-layout"><i class="fa fa-check"></i><b>6.2</b> Draw part of the circos layout</a></li>
<li class="chapter" data-level="6.3" data-path="advanced-usage.html"><a href="advanced-usage.html#combine-more-than-one-circos-plots"><i class="fa fa-check"></i><b>6.3</b> Combine more than one circos plots</a></li>
<li class="chapter" data-level="6.4" data-path="advanced-usage.html"><a href="advanced-usage.html#draw-outside-and-combine-with-canvas-coordinate"><i class="fa fa-check"></i><b>6.4</b> Draw outside and combine with canvas coordinate</a></li>
<li class="chapter" data-level="6.5" data-path="advanced-usage.html"><a href="advanced-usage.html#arrange-multiple-plots"><i class="fa fa-check"></i><b>6.5</b> Arrange multiple plots</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="legends.html"><a href="legends.html"><i class="fa fa-check"></i><b>7</b> Legends</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Circular Visualization</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="advanced-usage" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Advanced usage</h1>
<div id="zooming-of-sectors" class="section level2">
<h2><span class="header-section-number">6.1</span> Zooming of sectors</h2>
<p>Under the default settings, width of sectors are calculated according to the range of data in each category. In some circumstance, you may want to manually set the width of each sector. Normally it is not a good idea since width of sectors can reflect useful information of your data. However, sometimes it is useful to modify the width of sectors, e.g., you want to put your plot only in half of the circle while in the other half of the circle, zooming of certain sectors are applied. The width of sectors can be manually set by {sector.width} argument in {circos.initialize}. The value for the argument should be a vector with length of either one or as same as the number of categories (again, order of {sector.width} vector corresponds to the order of levels of {factors}). {sector.width} is relative value, and it will be scaled to percentage (e.g. if you set {sector.width} to {c(1, 3)}, it will be scaled as {c(0.25, 0.75)}).</p>
<p>In order to zoom e.g. one sector, the copy of the data corresponding to this sector should be attached to the original data. Since these two sectors (original sector and the zoomed sector) contain the same data, if same plotting functions are applied to them, there will be same graphics generated.</p>
<p>In the following code, sector a and b are zoomed. To make thing simple, we put all data into one data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df =<span class="st"> </span><span class="kw">data.frame</span>(
    <span class="dt">factors =</span> <span class="kw">sample</span>(letters[<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>], <span class="dv">100</span>, <span class="dt">replace =</span> <span class="ot">TRUE</span>),
    <span class="dt">x =</span> <span class="kw">rnorm</span>(<span class="dv">100</span>),
    <span class="dt">y =</span> <span class="kw">rnorm</span>(<span class="dv">100</span>),
    <span class="dt">stringsAsFactors =</span> <span class="ot">FALSE</span>
)</code></pre></div>
<p>Extract the data for sector a and b, and assign to a new variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zoom_df =<span class="st"> </span>df[df<span class="op">$</span>factors <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>), ]</code></pre></div>
<p>Modify the names for the zoomed sector, because in the circos plot, zoomed sectors are same as other normal sectors. Attach to the original data frame.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">zoom_df<span class="op">$</span>factors =<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;zoom_&quot;</span>, zoom_df<span class="op">$</span>factors)
df2 =<span class="st"> </span><span class="kw">rbind</span>(df, zoom_df)</code></pre></div>
<p>In order to put the normal sectors in half of the circle and the zoomed sectors in the other half, just normalize the width of normal sectors and normalize the width of zoomed sectors separately.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xrange =<span class="st"> </span><span class="kw">tapply</span>(df2<span class="op">$</span>x, df2<span class="op">$</span>factors, <span class="cf">function</span>(x) <span class="kw">max</span>(x) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(x))
normal_sector_index =<span class="st"> </span><span class="kw">unique</span>(df<span class="op">$</span>factors)
zoomed_sector_index =<span class="st"> </span><span class="kw">unique</span>(zoom_df<span class="op">$</span>factors)
sector.width =<span class="st"> </span><span class="kw">c</span>(xrange[normal_sector_index] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(xrange[normal_sector_index]), 
                 xrange[zoomed_sector_index] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(xrange[zoomed_sector_index]))</code></pre></div>
<p>Now make the circos plot in the normal way.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))
<span class="kw">circos.par</span>(<span class="dt">start.degree =</span> <span class="dv">90</span>)
<span class="kw">circos.initialize</span>(df2<span class="op">$</span>factors, <span class="dt">x =</span> df2<span class="op">$</span>x, <span class="dt">sector.width =</span> sector.width)
<span class="kw">circos.trackPlotRegion</span>(df2<span class="op">$</span>factors, <span class="dt">x =</span> df2<span class="op">$</span>x, <span class="dt">y =</span> df2<span class="op">$</span>y, <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {
    <span class="kw">circos.points</span>(x, y, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)
    xlim =<span class="st"> </span><span class="kw">get.cell.meta.data</span>(<span class="st">&quot;xlim&quot;</span>)
    ylim =<span class="st"> </span><span class="kw">get.cell.meta.data</span>(<span class="st">&quot;ylim&quot;</span>)
    sector.index =<span class="st"> </span><span class="kw">get.cell.meta.data</span>(<span class="st">&quot;sector.index&quot;</span>)
    <span class="kw">circos.text</span>(<span class="kw">mean</span>(xlim), <span class="kw">mean</span>(ylim), sector.index, <span class="dt">niceFacing =</span> <span class="ot">TRUE</span>)
})</code></pre></div>
<p>If you want to add links from original sectors to zoomed sectors,</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">circos.link</span>(<span class="st">&quot;a&quot;</span>, <span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.xlim&quot;</span>, <span class="dt">sector.index =</span> <span class="st">&quot;a&quot;</span>),
    <span class="st">&quot;zoom_a&quot;</span>, <span class="kw">get.cell.meta.data</span>(<span class="st">&quot;cell.xlim&quot;</span>, <span class="dt">sector.index =</span> <span class="st">&quot;zoom_a&quot;</span>),
    <span class="dt">border =</span> <span class="ot">NA</span>, <span class="dt">col =</span> <span class="st">&quot;#00000020&quot;</span>)
<span class="kw">circos.clear</span>()</code></pre></div>
<div class="figure">
<img src="bookdown-demo_files/figure-html/circlize_zoom-1.png" alt="Zoom sectors." width="672" />
<p class="caption">
(#fig:circlize_zoom)Zoom sectors.
</p>
</div>
</div>
<div id="draw-part-of-the-circos-layout" class="section level2">
<h2><span class="header-section-number">6.2</span> Draw part of the circos layout</h2>
<p>{canvas.xlim} and {canvas.ylim} in {circos.par} is useful to make figures on only part of circle. In the example, only sectors between <span class="math inline">\(0^\circ\)</span> to <span class="math inline">\(90^\circ\)</span> are plotted (figure ). First, four sectors with the same width are initialized. Then only the first sector is drawn with points and lines. From figure , we in fact created the whole circle, but only a quarter of the circle is in the canvas region. Codes are as follows.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">circos.par</span>(<span class="st">&quot;canvas.xlim&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="st">&quot;canvas.ylim&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),
    <span class="st">&quot;clock.wise&quot;</span> =<span class="st"> </span><span class="ot">FALSE</span>, <span class="st">&quot;gap.degree&quot;</span> =<span class="st"> </span><span class="dv">0</span>)
factors =<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]
<span class="kw">circos.initialize</span>(<span class="dt">factors =</span> factors, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
<span class="kw">circos.trackPlotRegion</span>(<span class="dt">factors =</span> factors, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">bg.border =</span> <span class="ot">NA</span>)
<span class="kw">circos.updatePlotRegion</span>(<span class="dt">sector.index =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">bg.border =</span> <span class="st">&quot;black&quot;</span>)
x1 =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">100</span>)
y1 =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">100</span>)
<span class="kw">circos.points</span>(x1, y1, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)
<span class="kw">circos.trackPlotRegion</span>(<span class="dt">factors =</span> factors, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">bg.border =</span> <span class="ot">NA</span>)
<span class="kw">circos.updatePlotRegion</span>(<span class="dt">sector.index =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">bg.border =</span> <span class="st">&quot;black&quot;</span>)
<span class="kw">circos.lines</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span><span class="op">/</span><span class="dv">100</span>, y1, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)
<span class="kw">circos.clear</span>()</code></pre></div>
<div class="figure">
<img src="bookdown-demo_files/figure-html/circlize_part-1.png" alt="One quarter of the circle." width="576" />
<p class="caption">
(#fig:circlize_part)One quarter of the circle.
</p>
</div>
<p>In the second situation, in some tracks, you only need to add graphic on subset of sectors. Remember when you are creating new track with {circos.trackPlotRegion} and set {bg.col} and {bg.border} to {NA}, it means create the new track while draw nothing. After that, you can use {circos.updatePlotRegion} to update these invisible cells of interest and add graphics on it (figure ).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))
factors =<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]
<span class="kw">circos.initialize</span>(<span class="dt">factors =</span> factors, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
<span class="kw">circos.trackPlotRegion</span>(<span class="dt">factors =</span> factors, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">bg.col =</span> <span class="ot">NA</span>, <span class="dt">bg.border =</span> <span class="ot">NA</span>)
<span class="kw">circos.updatePlotRegion</span>(<span class="dt">sector.index =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">bg.border =</span> <span class="st">&quot;black&quot;</span>)
x1 =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">100</span>)
y1 =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">100</span>)
<span class="kw">circos.points</span>(x1, y1, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)

<span class="kw">circos.trackPlotRegion</span>(<span class="dt">factors =</span> factors, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>),<span class="dt">bg.col =</span> <span class="ot">NA</span>, <span class="dt">bg.border =</span> <span class="ot">NA</span>)
<span class="kw">circos.updatePlotRegion</span>(<span class="dt">sector.index =</span> <span class="st">&quot;a&quot;</span>, <span class="dt">bg.border =</span> <span class="st">&quot;black&quot;</span>)
x1 =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">100</span>)
y1 =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">100</span>)
<span class="kw">circos.points</span>(x1, y1, <span class="dt">pch =</span> <span class="dv">16</span>, <span class="dt">cex =</span> <span class="fl">0.5</span>)

<span class="kw">circos.trackPlotRegion</span>(<span class="dt">factors =</span> factors, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
<span class="kw">circos.trackPlotRegion</span>(<span class="dt">factors =</span> factors, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
<span class="kw">circos.clear</span>()</code></pre></div>
<div class="figure">
<img src="bookdown-demo_files/figure-html/circlize_part2-1.png" alt="Only plot subset of sectors in certain tracks." width="672" />
<p class="caption">
(#fig:circlize_part2)Only plot subset of sectors in certain tracks.
</p>
</div>
</div>
<div id="combine-more-than-one-circos-plots" class="section level2">
<h2><span class="header-section-number">6.3</span> Combine more than one circos plots</h2>
<p>Since circular layout by  is finally plotted in an ordinary R plotting system. Two seperated circular layouts can be plotted together by some tricks. Here the key is {par(new = TRUE)} which allows to draw a new figure on the previous canvas region. {}</p>
<p>The first example is to make one outer circos plot and an inner circos plot (figure ).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))
factors =<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]
<span class="kw">circos.initialize</span>(<span class="dt">factors =</span> factors, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
<span class="kw">circos.trackPlotRegion</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {
    <span class="kw">circos.text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">&quot;outer circos&quot;</span>)
})
<span class="kw">circos.clear</span>()

<span class="kw">par</span>(<span class="dt">new =</span> <span class="ot">TRUE</span>)
<span class="kw">circos.par</span>(<span class="st">&quot;canvas.xlim&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>), <span class="st">&quot;canvas.ylim&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="dv">2</span>))
factors =<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]
<span class="kw">circos.initialize</span>(<span class="dt">factors =</span> factors, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
<span class="kw">circos.trackPlotRegion</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {
    <span class="kw">circos.text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">&quot;inner circos&quot;</span>)
})
<span class="kw">circos.clear</span>()</code></pre></div>
<div class="figure">
<img src="bookdown-demo_files/figure-html/circlize_nested-1.png" alt="An outer circos plot plus an inner one." width="672" />
<p class="caption">
(#fig:circlize_nested)An outer circos plot plus an inner one.
</p>
</div>
<p>The second example is to make two separated circos plot in which every circos plot only contains a half (figure ).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))
factors =<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]
<span class="kw">circos.par</span>(<span class="st">&quot;canvas.xlim&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="fl">1.5</span>), <span class="st">&quot;canvas.ylim&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">1</span>, <span class="fl">1.5</span>), <span class="dt">start.degree =</span> <span class="op">-</span><span class="dv">45</span>)
<span class="kw">circos.initialize</span>(<span class="dt">factors =</span> factors, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
<span class="kw">circos.trackPlotRegion</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">bg.col =</span> <span class="ot">NA</span>, <span class="dt">bg.border =</span> <span class="ot">NA</span>)
<span class="kw">circos.updatePlotRegion</span>(<span class="dt">sector.index =</span> <span class="st">&quot;a&quot;</span>)
<span class="kw">circos.text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">&quot;first one&quot;</span>)
<span class="kw">circos.updatePlotRegion</span>(<span class="dt">sector.index =</span> <span class="st">&quot;b&quot;</span>)
<span class="kw">circos.text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">&quot;first one&quot;</span>)

<span class="kw">circos.clear</span>()

<span class="kw">par</span>(<span class="dt">new =</span> <span class="ot">TRUE</span>)
<span class="kw">circos.par</span>(<span class="st">&quot;canvas.xlim&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="dv">1</span>), <span class="st">&quot;canvas.ylim&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="dv">1</span>), <span class="dt">start.degree =</span> <span class="op">-</span><span class="dv">45</span>)
<span class="kw">circos.initialize</span>(<span class="dt">factors =</span> factors, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
<span class="kw">circos.trackPlotRegion</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">bg.col =</span> <span class="ot">NA</span>, <span class="dt">bg.border =</span> <span class="ot">NA</span>)
<span class="kw">circos.updatePlotRegion</span>(<span class="dt">sector.index =</span> <span class="st">&quot;d&quot;</span>)
<span class="kw">circos.text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">&quot;second one&quot;</span>)
<span class="kw">circos.updatePlotRegion</span>(<span class="dt">sector.index =</span> <span class="st">&quot;c&quot;</span>)
<span class="kw">circos.text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="st">&quot;second one&quot;</span>)

<span class="kw">circos.clear</span>()</code></pre></div>
<div class="figure">
<img src="bookdown-demo_files/figure-html/circlize_separated-1.png" alt="Two separated circos plots" width="672" />
<p class="caption">
(#fig:circlize_separated)Two separated circos plots
</p>
</div>
<p>The third example is to draw sectors with different radius (figure ). In fact, it makes four circos plots in which only one sector of each graphs is plotted. Note links can not be drawn in these different sectors because links can only be drawn in one circos plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(circlize)
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))
factors =<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]
lim =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">1.1</span>, <span class="fl">1.2</span>, <span class="fl">1.3</span>)
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {
    <span class="kw">circos.par</span>(<span class="st">&quot;canvas.xlim&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span>lim[i], lim[i]),
        <span class="st">&quot;canvas.ylim&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span>lim[i], lim[i]), <span class="st">&quot;track.height&quot;</span> =<span class="st"> </span><span class="fl">0.4</span>)
    <span class="kw">circos.initialize</span>(<span class="dt">factors =</span> factors, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
    <span class="kw">circos.trackPlotRegion</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">bg.border =</span> <span class="ot">NA</span>)
    <span class="kw">circos.updatePlotRegion</span>(<span class="dt">sector.index =</span> factors[i], <span class="dt">bg.border =</span> <span class="st">&quot;black&quot;</span>)
    <span class="kw">circos.points</span>(<span class="kw">runif</span>(<span class="dv">10</span>), <span class="kw">runif</span>(<span class="dv">10</span>), <span class="dt">pch =</span> <span class="dv">16</span>)
    <span class="kw">circos.clear</span>()
    <span class="kw">par</span>(<span class="dt">new =</span> <span class="ot">TRUE</span>)
}
<span class="kw">par</span>(<span class="dt">new =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>It is different from example in ``Draw part of the circos layout’’ section. In that example, cells both visible and invisible all belong to a same track and they are in a same circos plot, so they should have same radius. But here, cells have different radius and they belong to different circos plot.</p>
<div class="figure">
<img src="bookdown-demo_files/figure-html/circlize_diff_radius-1.png" alt="Sectors with different radius." width="672" />
<p class="caption">
(#fig:circlize_diff_radius)Sectors with different radius.
</p>
</div>
</div>
<div id="draw-outside-and-combine-with-canvas-coordinate" class="section level2">
<h2><span class="header-section-number">6.4</span> Draw outside and combine with canvas coordinate</h2>
<p>Sometimes it is very useful to draw something outside plotting region. (You can think it is similar as {par(xpd = NA)} setting.) The following is a simple example to illustrate such circumstance (figure ).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">12345</span>)
<span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>))
factors =<span class="st"> </span>letters[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>]
<span class="kw">circos.par</span>(<span class="st">&quot;canvas.xlim&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>), <span class="st">&quot;canvas.ylim&quot;</span> =<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="fl">1.5</span>, <span class="fl">1.5</span>), <span class="st">&quot;gap.degree&quot;</span> =<span class="st"> </span><span class="dv">10</span>)
<span class="kw">circos.initialize</span>(<span class="dt">factors =</span> factors, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
<span class="kw">circos.trackPlotRegion</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {
    <span class="kw">circos.points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span><span class="op">/</span><span class="dv">20</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">20</span><span class="op">/</span><span class="dv">20</span>)
})
<span class="kw">circos.lines</span>(<span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">20</span>, <span class="fl">0.5</span>), <span class="kw">c</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">20</span>, <span class="dv">3</span>), <span class="dt">sector.index =</span> <span class="st">&quot;d&quot;</span>, <span class="dt">straight =</span> <span class="ot">TRUE</span>)
<span class="kw">circos.text</span>(<span class="fl">0.5</span>, <span class="dv">3</span>, <span class="st">&quot;mark&quot;</span>, <span class="dt">sector.index =</span> <span class="st">&quot;d&quot;</span>, <span class="dt">adj =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="dv">0</span>))

<span class="kw">circos.trackPlotRegion</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">panel.fun =</span> <span class="cf">function</span>(x, y) {
    <span class="kw">circos.points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">20</span><span class="op">/</span><span class="dv">20</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">20</span><span class="op">/</span><span class="dv">20</span>)
})
<span class="kw">text</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="st">&quot;this is</span><span class="ch">\n</span><span class="st">the center&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.5</span>)
<span class="kw">legend</span>(<span class="st">&quot;bottomleft&quot;</span>, <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">legend =</span> <span class="st">&quot;this is the legend&quot;</span>)
<span class="kw">circos.clear</span>()</code></pre></div>
<p>Since the final graphics are plotted in an ordinary canvas plotting region, we can add additional graphics through the traditional way, such as legends, texts, …</p>
<div class="figure">
<img src="bookdown-demo_files/figure-html/circlize_outside-1.png" alt="Draw outside the cell and combine with canvas coordinate." width="672" />
<p class="caption">
(#fig:circlize_outside)Draw outside the cell and combine with canvas coordinate.
</p>
</div>
</div>
<div id="arrange-multiple-plots" class="section level2">
<h2><span class="header-section-number">6.5</span> Arrange multiple plots</h2>
<p><strong>circlize</strong> is implemented in the base R graphic system, thus, you can use <code>layout()</code> or <code>par(mforw, mfcol)</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dv">3</span>, <span class="dv">3</span>))
<span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">9</span>) {
    factors =<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">8</span>
    <span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span>))
    <span class="kw">circos.par</span>(<span class="dt">cell.padding =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))
    <span class="kw">circos.initialize</span>(factors, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>))
    <span class="kw">circos.trackPlotRegion</span>(<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">track.height =</span> <span class="fl">0.05</span>,
        <span class="dt">bg.col =</span> <span class="kw">rand_color</span>(<span class="dv">8</span>), <span class="dt">bg.border =</span> <span class="ot">NA</span>)
    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">20</span>) {
        se =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">8</span>, <span class="dv">2</span>)
        <span class="kw">circos.link</span>(se[<span class="dv">1</span>], <span class="kw">runif</span>(<span class="dv">2</span>), se[<span class="dv">2</span>], <span class="kw">runif</span>(<span class="dv">2</span>), 
            <span class="dt">col =</span> <span class="kw">rand_color</span>(<span class="dv">1</span>, <span class="dt">transparency =</span> <span class="fl">0.4</span>), <span class="dt">border =</span> <span class="ot">NA</span>)
    }
    <span class="kw">circos.clear</span>()
}</code></pre></div>
<div class="figure">
<img src="bookdown-demo_files/figure-html/circlize_layout-1.png" alt="Arrange multiple circos plots." width="768" />
<p class="caption">
(#fig:circlize_layout)Arrange multiple circos plots.
</p>
</div>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="high-level-plots.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="legends.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/07-advanced-usage.Rmd",
"text": "Edit"
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
